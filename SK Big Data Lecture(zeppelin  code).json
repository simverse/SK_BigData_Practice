{"paragraphs":[{"text":"%md\n\n여기에 만들어주세요\n\ns3 경로 : yelp-sk-test/yelp/business\n\n- hdfs internal parquet hive table list (database : yelp1)\n-- business_in\n-- restaurants_in\n-- review_filtered_in\n-- review_in\n-- user_in\n-- users_in","user":"anonymous","dateUpdated":"2018-06-20T01:30:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>여기에 만들어주세요</p>\n<p>s3 경로 : yelp-sk-test/yelp/business</p>\n<ul>\n<li>hdfs internal parquet hive table list (database : yelp1)\n<br  />&ndash; business_in\n<br  />&ndash; restaurants_in\n<br  />&ndash; review_filtered_in\n<br  />&ndash; review_in\n<br  />&ndash; user_in\n<br  />&ndash; users_in</li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1529456048101_1121360000","id":"20180620-005408_2128306519","dateCreated":"2018-06-20T00:54:08+0000","dateStarted":"2018-06-20T01:30:24+0000","dateFinished":"2018-06-20T01:30:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:17650"},{"text":"%md\n**Q1. Business TABLE**\n- Create EXPLODED table with flattened categories\nSince our file contains an array of categories we need to flatten those categories in order to be able to query them easily. We use LATERAL VIEW explode function for the column categories and alias it as cat_exploded\n-- Q1.1 List the values of the columns business_id, categories, cat_exploded from the table EXPLODED with 10 records selected:\n-- Q1.2 Find total number of businesses in the data set:\nSELECT count(business_id) FROM business4;\n","user":"anonymous","dateUpdated":"2018-06-20T02:14:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1529456876531_1224264745","id":"20180620-010756_1359873041","dateCreated":"2018-06-20T01:07:56+0000","dateStarted":"2018-06-20T02:08:52+0000","dateFinished":"2018-06-20T02:08:52+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17651"},{"text":"%pyspark\nfrom pyspark.sql.functions import explode, col\nbusiness = sqlContext.read.option(\"inferSchema\", \"true\").json(\"s3://yelp-sk-test/yelp/business/business.json\")\n# business.printSchema()\nbusiness_exp = business.withColumn(\"category\", explode(col('categories'))) \n# business_exp.printSchema()\nbusiness_exp.select(\"*\").show(10)","user":"anonymous","dateUpdated":"2018-06-20T02:02:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- address: string (nullable = true)\n |-- attributes: struct (nullable = true)\n |    |-- AcceptsInsurance: boolean (nullable = true)\n |    |-- AgesAllowed: string (nullable = true)\n |    |-- Alcohol: string (nullable = true)\n |    |-- Ambience: struct (nullable = true)\n |    |    |-- casual: boolean (nullable = true)\n |    |    |-- classy: boolean (nullable = true)\n |    |    |-- divey: boolean (nullable = true)\n |    |    |-- hipster: boolean (nullable = true)\n |    |    |-- intimate: boolean (nullable = true)\n |    |    |-- romantic: boolean (nullable = true)\n |    |    |-- touristy: boolean (nullable = true)\n |    |    |-- trendy: boolean (nullable = true)\n |    |    |-- upscale: boolean (nullable = true)\n |    |-- BYOB: boolean (nullable = true)\n |    |-- BYOBCorkage: string (nullable = true)\n |    |-- BestNights: struct (nullable = true)\n |    |    |-- friday: boolean (nullable = true)\n |    |    |-- monday: boolean (nullable = true)\n |    |    |-- saturday: boolean (nullable = true)\n |    |    |-- sunday: boolean (nullable = true)\n |    |    |-- thursday: boolean (nullable = true)\n |    |    |-- tuesday: boolean (nullable = true)\n |    |    |-- wednesday: boolean (nullable = true)\n |    |-- BikeParking: boolean (nullable = true)\n |    |-- BusinessAcceptsBitcoin: boolean (nullable = true)\n |    |-- BusinessAcceptsCreditCards: boolean (nullable = true)\n |    |-- BusinessParking: struct (nullable = true)\n |    |    |-- garage: boolean (nullable = true)\n |    |    |-- lot: boolean (nullable = true)\n |    |    |-- street: boolean (nullable = true)\n |    |    |-- valet: boolean (nullable = true)\n |    |    |-- validated: boolean (nullable = true)\n |    |-- ByAppointmentOnly: boolean (nullable = true)\n |    |-- Caters: boolean (nullable = true)\n |    |-- CoatCheck: boolean (nullable = true)\n |    |-- Corkage: boolean (nullable = true)\n |    |-- DietaryRestrictions: struct (nullable = true)\n |    |    |-- dairy-free: boolean (nullable = true)\n |    |    |-- gluten-free: boolean (nullable = true)\n |    |    |-- halal: boolean (nullable = true)\n |    |    |-- kosher: boolean (nullable = true)\n |    |    |-- soy-free: boolean (nullable = true)\n |    |    |-- vegan: boolean (nullable = true)\n |    |    |-- vegetarian: boolean (nullable = true)\n |    |-- DogsAllowed: boolean (nullable = true)\n |    |-- DriveThru: boolean (nullable = true)\n |    |-- GoodForDancing: boolean (nullable = true)\n |    |-- GoodForKids: boolean (nullable = true)\n |    |-- GoodForMeal: struct (nullable = true)\n |    |    |-- breakfast: boolean (nullable = true)\n |    |    |-- brunch: boolean (nullable = true)\n |    |    |-- dessert: boolean (nullable = true)\n |    |    |-- dinner: boolean (nullable = true)\n |    |    |-- latenight: boolean (nullable = true)\n |    |    |-- lunch: boolean (nullable = true)\n |    |-- HairSpecializesIn: struct (nullable = true)\n |    |    |-- africanamerican: boolean (nullable = true)\n |    |    |-- asian: boolean (nullable = true)\n |    |    |-- coloring: boolean (nullable = true)\n |    |    |-- curly: boolean (nullable = true)\n |    |    |-- extensions: boolean (nullable = true)\n |    |    |-- kids: boolean (nullable = true)\n |    |    |-- perms: boolean (nullable = true)\n |    |    |-- straightperms: boolean (nullable = true)\n |    |-- HappyHour: boolean (nullable = true)\n |    |-- HasTV: boolean (nullable = true)\n |    |-- Music: struct (nullable = true)\n |    |    |-- background_music: boolean (nullable = true)\n |    |    |-- dj: boolean (nullable = true)\n |    |    |-- jukebox: boolean (nullable = true)\n |    |    |-- karaoke: boolean (nullable = true)\n |    |    |-- live: boolean (nullable = true)\n |    |    |-- no_music: boolean (nullable = true)\n |    |    |-- video: boolean (nullable = true)\n |    |-- NoiseLevel: string (nullable = true)\n |    |-- Open24Hours: boolean (nullable = true)\n |    |-- OutdoorSeating: boolean (nullable = true)\n |    |-- RestaurantsAttire: string (nullable = true)\n |    |-- RestaurantsCounterService: boolean (nullable = true)\n |    |-- RestaurantsDelivery: boolean (nullable = true)\n |    |-- RestaurantsGoodForGroups: boolean (nullable = true)\n |    |-- RestaurantsPriceRange2: long (nullable = true)\n |    |-- RestaurantsReservations: boolean (nullable = true)\n |    |-- RestaurantsTableService: boolean (nullable = true)\n |    |-- RestaurantsTakeOut: boolean (nullable = true)\n |    |-- Smoking: string (nullable = true)\n |    |-- WheelchairAccessible: boolean (nullable = true)\n |    |-- WiFi: string (nullable = true)\n |-- business_id: string (nullable = true)\n |-- categories: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- city: string (nullable = true)\n |-- hours: struct (nullable = true)\n |    |-- Friday: string (nullable = true)\n |    |-- Monday: string (nullable = true)\n |    |-- Saturday: string (nullable = true)\n |    |-- Sunday: string (nullable = true)\n |    |-- Thursday: string (nullable = true)\n |    |-- Tuesday: string (nullable = true)\n |    |-- Wednesday: string (nullable = true)\n |-- is_open: long (nullable = true)\n |-- latitude: double (nullable = true)\n |-- longitude: double (nullable = true)\n |-- name: string (nullable = true)\n |-- neighborhood: string (nullable = true)\n |-- postal_code: string (nullable = true)\n |-- review_count: long (nullable = true)\n |-- stars: double (nullable = true)\n |-- state: string (nullable = true)\n |-- category: string (nullable = true)\n\n+--------------------+--------------------+--------------------+--------------------+---------+--------------------+-------+----------+------------+-------------------+------------+-----------+------------+-----+-----+--------------------+\n|             address|          attributes|         business_id|          categories|     city|               hours|is_open|  latitude|   longitude|               name|neighborhood|postal_code|review_count|stars|state|            category|\n+--------------------+--------------------+--------------------+--------------------+---------+--------------------+-------+----------+------------+-------------------+------------+-----------+------------+-----+-----+--------------------+\n|4855 E Warner Rd,...|[true,,,,,,,,, tr...|FYWN1wneV18bWNgQj...|[Dentists, Genera...|Ahwatukee|[7:30-17:00, 7:30...|      1|33.3306902|-111.9785992|   Dental by Design|            |      85044|          22|  4.0|   AZ|            Dentists|\n|4855 E Warner Rd,...|[true,,,,,,,,, tr...|FYWN1wneV18bWNgQj...|[Dentists, Genera...|Ahwatukee|[7:30-17:00, 7:30...|      1|33.3306902|-111.9785992|   Dental by Design|            |      85044|          22|  4.0|   AZ|   General Dentistry|\n|4855 E Warner Rd,...|[true,,,,,,,,, tr...|FYWN1wneV18bWNgQj...|[Dentists, Genera...|Ahwatukee|[7:30-17:00, 7:30...|      1|33.3306902|-111.9785992|   Dental by Design|            |      85044|          22|  4.0|   AZ|    Health & Medical|\n|4855 E Warner Rd,...|[true,,,,,,,,, tr...|FYWN1wneV18bWNgQj...|[Dentists, Genera...|Ahwatukee|[7:30-17:00, 7:30...|      1|33.3306902|-111.9785992|   Dental by Design|            |      85044|          22|  4.0|   AZ|       Oral Surgeons|\n|4855 E Warner Rd,...|[true,,,,,,,,, tr...|FYWN1wneV18bWNgQj...|[Dentists, Genera...|Ahwatukee|[7:30-17:00, 7:30...|      1|33.3306902|-111.9785992|   Dental by Design|            |      85044|          22|  4.0|   AZ|   Cosmetic Dentists|\n|4855 E Warner Rd,...|[true,,,,,,,,, tr...|FYWN1wneV18bWNgQj...|[Dentists, Genera...|Ahwatukee|[7:30-17:00, 7:30...|      1|33.3306902|-111.9785992|   Dental by Design|            |      85044|          22|  4.0|   AZ|       Orthodontists|\n|  3101 Washington Rd|[,,,,,,,,, true, ...|He-G7vWjzVUysIKrf...|[Hair Stylists, H...| McMurray|[9:00-16:00, 9:00...|      1|40.2916853| -80.1048999|Stephen Szabo Salon|            |      15317|          11|  3.0|   PA|       Hair Stylists|\n|  3101 Washington Rd|[,,,,,,,,, true, ...|He-G7vWjzVUysIKrf...|[Hair Stylists, H...| McMurray|[9:00-16:00, 9:00...|      1|40.2916853| -80.1048999|Stephen Szabo Salon|            |      15317|          11|  3.0|   PA|         Hair Salons|\n|  3101 Washington Rd|[,,,,,,,,, true, ...|He-G7vWjzVUysIKrf...|[Hair Stylists, H...| McMurray|[9:00-16:00, 9:00...|      1|40.2916853| -80.1048999|Stephen Szabo Salon|            |      15317|          11|  3.0|   PA|   Men's Hair Salons|\n|  3101 Washington Rd|[,,,,,,,,, true, ...|He-G7vWjzVUysIKrf...|[Hair Stylists, H...| McMurray|[9:00-16:00, 9:00...|      1|40.2916853| -80.1048999|Stephen Szabo Salon|            |      15317|          11|  3.0|   PA|Blow Dry/Out Serv...|\n+--------------------+--------------------+--------------------+--------------------+---------+--------------------+-------+----------+------------+-------------------+------------+-----------+------------+-----+-----+--------------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1529458408254_207549069","id":"20180620-013328_2108077465","dateCreated":"2018-06-20T01:33:28+0000","dateStarted":"2018-06-20T02:00:41+0000","dateFinished":"2018-06-20T02:00:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17652"},{"text":"%pyspark\n#business_exp.printSchema()\n#business_exp.count()\n#business_exp.select(\"business_id\").distinct().count()\nbusiness_exp.describe('business_id').show()\n\n","user":"anonymous","dateUpdated":"2018-06-20T02:06:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------------------+\n|summary|         business_id|\n+-------+--------------------+\n|  count|              667527|\n|   mean|                null|\n| stddev|                null|\n|    min|--6MefnULPED_I942...|\n|    max|zzzaIBwimxVej4tY6...|\n+-------+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1529459828269_-1713125139","id":"20180620-015708_1322775038","dateCreated":"2018-06-20T01:57:08+0000","dateStarted":"2018-06-20T02:05:44+0000","dateFinished":"2018-06-20T02:05:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17653"},{"text":"%pyspark\nfrom pyspark.sql import HiveContext\nhc = HiveContext(sc)\n\n#business = sqlContext.read.option(\"inferSchema\", \"true\").json(\"s3://yelp-sk-test/yelp/business/business.json\")\n# business.printSchema()\n#business_exp = business.withColumn(\"category\", explode(col('categories'))) \n\n\ndf_json = hc.read.json(\"s3://yelp-sk-test/yelp/business/business.json\")\ndf_json.printSchema()\ndf_json_exp = df_json.withColumn(\"category\", explode(col('categories'))) \n\ndf_json_exp.write.mode(\"overwrite\").format(\"parquet\").saveAsTable(\"yelp2.business_exp\")\n\n","user":"anonymous","dateUpdated":"2018-06-20T02:12:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- address: string (nullable = true)\n |-- attributes: struct (nullable = true)\n |    |-- AcceptsInsurance: boolean (nullable = true)\n |    |-- AgesAllowed: string (nullable = true)\n |    |-- Alcohol: string (nullable = true)\n |    |-- Ambience: struct (nullable = true)\n |    |    |-- casual: boolean (nullable = true)\n |    |    |-- classy: boolean (nullable = true)\n |    |    |-- divey: boolean (nullable = true)\n |    |    |-- hipster: boolean (nullable = true)\n |    |    |-- intimate: boolean (nullable = true)\n |    |    |-- romantic: boolean (nullable = true)\n |    |    |-- touristy: boolean (nullable = true)\n |    |    |-- trendy: boolean (nullable = true)\n |    |    |-- upscale: boolean (nullable = true)\n |    |-- BYOB: boolean (nullable = true)\n |    |-- BYOBCorkage: string (nullable = true)\n |    |-- BestNights: struct (nullable = true)\n |    |    |-- friday: boolean (nullable = true)\n |    |    |-- monday: boolean (nullable = true)\n |    |    |-- saturday: boolean (nullable = true)\n |    |    |-- sunday: boolean (nullable = true)\n |    |    |-- thursday: boolean (nullable = true)\n |    |    |-- tuesday: boolean (nullable = true)\n |    |    |-- wednesday: boolean (nullable = true)\n |    |-- BikeParking: boolean (nullable = true)\n |    |-- BusinessAcceptsBitcoin: boolean (nullable = true)\n |    |-- BusinessAcceptsCreditCards: boolean (nullable = true)\n |    |-- BusinessParking: struct (nullable = true)\n |    |    |-- garage: boolean (nullable = true)\n |    |    |-- lot: boolean (nullable = true)\n |    |    |-- street: boolean (nullable = true)\n |    |    |-- valet: boolean (nullable = true)\n |    |    |-- validated: boolean (nullable = true)\n |    |-- ByAppointmentOnly: boolean (nullable = true)\n |    |-- Caters: boolean (nullable = true)\n |    |-- CoatCheck: boolean (nullable = true)\n |    |-- Corkage: boolean (nullable = true)\n |    |-- DietaryRestrictions: struct (nullable = true)\n |    |    |-- dairy-free: boolean (nullable = true)\n |    |    |-- gluten-free: boolean (nullable = true)\n |    |    |-- halal: boolean (nullable = true)\n |    |    |-- kosher: boolean (nullable = true)\n |    |    |-- soy-free: boolean (nullable = true)\n |    |    |-- vegan: boolean (nullable = true)\n |    |    |-- vegetarian: boolean (nullable = true)\n |    |-- DogsAllowed: boolean (nullable = true)\n |    |-- DriveThru: boolean (nullable = true)\n |    |-- GoodForDancing: boolean (nullable = true)\n |    |-- GoodForKids: boolean (nullable = true)\n |    |-- GoodForMeal: struct (nullable = true)\n |    |    |-- breakfast: boolean (nullable = true)\n |    |    |-- brunch: boolean (nullable = true)\n |    |    |-- dessert: boolean (nullable = true)\n |    |    |-- dinner: boolean (nullable = true)\n |    |    |-- latenight: boolean (nullable = true)\n |    |    |-- lunch: boolean (nullable = true)\n |    |-- HairSpecializesIn: struct (nullable = true)\n |    |    |-- africanamerican: boolean (nullable = true)\n |    |    |-- asian: boolean (nullable = true)\n |    |    |-- coloring: boolean (nullable = true)\n |    |    |-- curly: boolean (nullable = true)\n |    |    |-- extensions: boolean (nullable = true)\n |    |    |-- kids: boolean (nullable = true)\n |    |    |-- perms: boolean (nullable = true)\n |    |    |-- straightperms: boolean (nullable = true)\n |    |-- HappyHour: boolean (nullable = true)\n |    |-- HasTV: boolean (nullable = true)\n |    |-- Music: struct (nullable = true)\n |    |    |-- background_music: boolean (nullable = true)\n |    |    |-- dj: boolean (nullable = true)\n |    |    |-- jukebox: boolean (nullable = true)\n |    |    |-- karaoke: boolean (nullable = true)\n |    |    |-- live: boolean (nullable = true)\n |    |    |-- no_music: boolean (nullable = true)\n |    |    |-- video: boolean (nullable = true)\n |    |-- NoiseLevel: string (nullable = true)\n |    |-- Open24Hours: boolean (nullable = true)\n |    |-- OutdoorSeating: boolean (nullable = true)\n |    |-- RestaurantsAttire: string (nullable = true)\n |    |-- RestaurantsCounterService: boolean (nullable = true)\n |    |-- RestaurantsDelivery: boolean (nullable = true)\n |    |-- RestaurantsGoodForGroups: boolean (nullable = true)\n |    |-- RestaurantsPriceRange2: long (nullable = true)\n |    |-- RestaurantsReservations: boolean (nullable = true)\n |    |-- RestaurantsTableService: boolean (nullable = true)\n |    |-- RestaurantsTakeOut: boolean (nullable = true)\n |    |-- Smoking: string (nullable = true)\n |    |-- WheelchairAccessible: boolean (nullable = true)\n |    |-- WiFi: string (nullable = true)\n |-- business_id: string (nullable = true)\n |-- categories: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- city: string (nullable = true)\n |-- hours: struct (nullable = true)\n |    |-- Friday: string (nullable = true)\n |    |-- Monday: string (nullable = true)\n |    |-- Saturday: string (nullable = true)\n |    |-- Sunday: string (nullable = true)\n |    |-- Thursday: string (nullable = true)\n |    |-- Tuesday: string (nullable = true)\n |    |-- Wednesday: string (nullable = true)\n |-- is_open: long (nullable = true)\n |-- latitude: double (nullable = true)\n |-- longitude: double (nullable = true)\n |-- name: string (nullable = true)\n |-- neighborhood: string (nullable = true)\n |-- postal_code: string (nullable = true)\n |-- review_count: long (nullable = true)\n |-- stars: double (nullable = true)\n |-- state: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1529460369637_437231007","id":"20180620-020609_398601514","dateCreated":"2018-06-20T02:06:09+0000","dateStarted":"2018-06-20T02:10:28+0000","dateFinished":"2018-06-20T02:10:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17654"},{"text":"%pyspark\nhc.table(\"yelp2.business_exp\").show()","user":"anonymous","dateUpdated":"2018-06-20T02:12:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+--------------+--------------------+-------+----------+------------+--------------------+------------+-----------+------------+-----+-----+--------------------+\n|             address|          attributes|         business_id|          categories|          city|               hours|is_open|  latitude|   longitude|                name|neighborhood|postal_code|review_count|stars|state|            category|\n+--------------------+--------------------+--------------------+--------------------+--------------+--------------------+-------+----------+------------+--------------------+------------+-----------+------------+-----+-----+--------------------+\n|4855 E Warner Rd,...|[true,,,,,,,,, tr...|FYWN1wneV18bWNgQj...|[Dentists, Genera...|     Ahwatukee|[7:30-17:00, 7:30...|      1|33.3306902|-111.9785992|    Dental by Design|            |      85044|          22|  4.0|   AZ|            Dentists|\n|4855 E Warner Rd,...|[true,,,,,,,,, tr...|FYWN1wneV18bWNgQj...|[Dentists, Genera...|     Ahwatukee|[7:30-17:00, 7:30...|      1|33.3306902|-111.9785992|    Dental by Design|            |      85044|          22|  4.0|   AZ|   General Dentistry|\n|4855 E Warner Rd,...|[true,,,,,,,,, tr...|FYWN1wneV18bWNgQj...|[Dentists, Genera...|     Ahwatukee|[7:30-17:00, 7:30...|      1|33.3306902|-111.9785992|    Dental by Design|            |      85044|          22|  4.0|   AZ|    Health & Medical|\n|4855 E Warner Rd,...|[true,,,,,,,,, tr...|FYWN1wneV18bWNgQj...|[Dentists, Genera...|     Ahwatukee|[7:30-17:00, 7:30...|      1|33.3306902|-111.9785992|    Dental by Design|            |      85044|          22|  4.0|   AZ|       Oral Surgeons|\n|4855 E Warner Rd,...|[true,,,,,,,,, tr...|FYWN1wneV18bWNgQj...|[Dentists, Genera...|     Ahwatukee|[7:30-17:00, 7:30...|      1|33.3306902|-111.9785992|    Dental by Design|            |      85044|          22|  4.0|   AZ|   Cosmetic Dentists|\n|4855 E Warner Rd,...|[true,,,,,,,,, tr...|FYWN1wneV18bWNgQj...|[Dentists, Genera...|     Ahwatukee|[7:30-17:00, 7:30...|      1|33.3306902|-111.9785992|    Dental by Design|            |      85044|          22|  4.0|   AZ|       Orthodontists|\n|  3101 Washington Rd|[,,,,,,,,, true, ...|He-G7vWjzVUysIKrf...|[Hair Stylists, H...|      McMurray|[9:00-16:00, 9:00...|      1|40.2916853| -80.1048999| Stephen Szabo Salon|            |      15317|          11|  3.0|   PA|       Hair Stylists|\n|  3101 Washington Rd|[,,,,,,,,, true, ...|He-G7vWjzVUysIKrf...|[Hair Stylists, H...|      McMurray|[9:00-16:00, 9:00...|      1|40.2916853| -80.1048999| Stephen Szabo Salon|            |      15317|          11|  3.0|   PA|         Hair Salons|\n|  3101 Washington Rd|[,,,,,,,,, true, ...|He-G7vWjzVUysIKrf...|[Hair Stylists, H...|      McMurray|[9:00-16:00, 9:00...|      1|40.2916853| -80.1048999| Stephen Szabo Salon|            |      15317|          11|  3.0|   PA|   Men's Hair Salons|\n|  3101 Washington Rd|[,,,,,,,,, true, ...|He-G7vWjzVUysIKrf...|[Hair Stylists, H...|      McMurray|[9:00-16:00, 9:00...|      1|40.2916853| -80.1048999| Stephen Szabo Salon|            |      15317|          11|  3.0|   PA|Blow Dry/Out Serv...|\n|  3101 Washington Rd|[,,,,,,,,, true, ...|He-G7vWjzVUysIKrf...|[Hair Stylists, H...|      McMurray|[9:00-16:00, 9:00...|      1|40.2916853| -80.1048999| Stephen Szabo Salon|            |      15317|          11|  3.0|   PA|     Hair Extensions|\n|  3101 Washington Rd|[,,,,,,,,, true, ...|He-G7vWjzVUysIKrf...|[Hair Stylists, H...|      McMurray|[9:00-16:00, 9:00...|      1|40.2916853| -80.1048999| Stephen Szabo Salon|            |      15317|          11|  3.0|   PA|       Beauty & Spas|\n|6025 N 27th Ave, ...|[,,,,,,,,,,,,,,,,...|KQPW8lFf1y5BT2Mxi...|[Departments of M...|       Phoenix|            [,,,,,,]|      1|33.5249025|-112.1153098|Western Motor Veh...|            |      85017|          18|  1.5|   AZ|Departments of Mo...|\n|6025 N 27th Ave, ...|[,,,,,,,,,,,,,,,,...|KQPW8lFf1y5BT2Mxi...|[Departments of M...|       Phoenix|            [,,,,,,]|      1|33.5249025|-112.1153098|Western Motor Veh...|            |      85017|          18|  1.5|   AZ|Public Services &...|\n|5000 Arizona Mill...|[,,,,,,, true,, t...|8DShNS-LuFqpEWIp0...|[Sporting Goods, ...|         Tempe|[10:00-21:00, 10:...|      0|33.3831468|-111.9647254|    Sports Authority|            |      85282|           9|  3.0|   AZ|      Sporting Goods|\n|5000 Arizona Mill...|[,,,,,,, true,, t...|8DShNS-LuFqpEWIp0...|[Sporting Goods, ...|         Tempe|[10:00-21:00, 10:...|      0|33.3831468|-111.9647254|    Sports Authority|            |      85282|           9|  3.0|   AZ|            Shopping|\n|        581 Howe Ave|[,, full_bar, [tr...|PfOCPjBrlQAnz__NX...|[American (New), ...|Cuyahoga Falls|[11:00-1:00, 11:0...|      1|41.1195346| -81.4756898|Brick House Taver...|            |      44221|         116|  3.5|   OH|      American (New)|\n|        581 Howe Ave|[,, full_bar, [tr...|PfOCPjBrlQAnz__NX...|[American (New), ...|Cuyahoga Falls|[11:00-1:00, 11:0...|      1|41.1195346| -81.4756898|Brick House Taver...|            |      44221|         116|  3.5|   OH|           Nightlife|\n|        581 Howe Ave|[,, full_bar, [tr...|PfOCPjBrlQAnz__NX...|[American (New), ...|Cuyahoga Falls|[11:00-1:00, 11:0...|      1|41.1195346| -81.4756898|Brick House Taver...|            |      44221|         116|  3.5|   OH|                Bars|\n|        581 Howe Ave|[,, full_bar, [tr...|PfOCPjBrlQAnz__NX...|[American (New), ...|Cuyahoga Falls|[11:00-1:00, 11:0...|      1|41.1195346| -81.4756898|Brick House Taver...|            |      44221|         116|  3.5|   OH|          Sandwiches|\n+--------------------+--------------------+--------------------+--------------------+--------------+--------------------+-------+----------+------------+--------------------+------------+-----------+------------+-----+-----+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1529460707163_-1573960408","id":"20180620-021147_252367574","dateCreated":"2018-06-20T02:11:47+0000","dateStarted":"2018-06-20T02:12:11+0000","dateFinished":"2018-06-20T02:12:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17655"},{"text":"%sql\nselect * from yelp2.business_exp limit 10\n","user":"anonymous","dateUpdated":"2018-06-20T02:14:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"address\tattributes\tbusiness_id\tcategories\tcity\thours\tis_open\tlatitude\tlongitude\tname\tneighborhood\tpostal_code\treview_count\tstars\tstate\tcategory\n4855 E Warner Rd, Ste B9\t[true,null,null,null,null,null,null,null,null,true,null,true,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]\tFYWN1wneV18bWNgQjJ2GNg\tWrappedArray(Dentists, General Dentistry, Health & Medical, Oral Surgeons, Cosmetic Dentists, Orthodontists)\tAhwatukee\t[7:30-17:00,7:30-17:00,null,null,7:30-17:00,7:30-17:00,7:30-17:00]\t1\t33.3306902\t-111.9785992\tDental by Design\t\t85044\t22\t4.0\tAZ\tDentists\n4855 E Warner Rd, Ste B9\t[true,null,null,null,null,null,null,null,null,true,null,true,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]\tFYWN1wneV18bWNgQjJ2GNg\tWrappedArray(Dentists, General Dentistry, Health & Medical, Oral Surgeons, Cosmetic Dentists, Orthodontists)\tAhwatukee\t[7:30-17:00,7:30-17:00,null,null,7:30-17:00,7:30-17:00,7:30-17:00]\t1\t33.3306902\t-111.9785992\tDental by Design\t\t85044\t22\t4.0\tAZ\tGeneral Dentistry\n4855 E Warner Rd, Ste B9\t[true,null,null,null,null,null,null,null,null,true,null,true,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]\tFYWN1wneV18bWNgQjJ2GNg\tWrappedArray(Dentists, General Dentistry, Health & Medical, Oral Surgeons, Cosmetic Dentists, Orthodontists)\tAhwatukee\t[7:30-17:00,7:30-17:00,null,null,7:30-17:00,7:30-17:00,7:30-17:00]\t1\t33.3306902\t-111.9785992\tDental by Design\t\t85044\t22\t4.0\tAZ\tHealth & Medical\n4855 E Warner Rd, Ste B9\t[true,null,null,null,null,null,null,null,null,true,null,true,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]\tFYWN1wneV18bWNgQjJ2GNg\tWrappedArray(Dentists, General Dentistry, Health & Medical, Oral Surgeons, Cosmetic Dentists, Orthodontists)\tAhwatukee\t[7:30-17:00,7:30-17:00,null,null,7:30-17:00,7:30-17:00,7:30-17:00]\t1\t33.3306902\t-111.9785992\tDental by Design\t\t85044\t22\t4.0\tAZ\tOral Surgeons\n4855 E Warner Rd, Ste B9\t[true,null,null,null,null,null,null,null,null,true,null,true,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]\tFYWN1wneV18bWNgQjJ2GNg\tWrappedArray(Dentists, General Dentistry, Health & Medical, Oral Surgeons, Cosmetic Dentists, Orthodontists)\tAhwatukee\t[7:30-17:00,7:30-17:00,null,null,7:30-17:00,7:30-17:00,7:30-17:00]\t1\t33.3306902\t-111.9785992\tDental by Design\t\t85044\t22\t4.0\tAZ\tCosmetic Dentists\n4855 E Warner Rd, Ste B9\t[true,null,null,null,null,null,null,null,null,true,null,true,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]\tFYWN1wneV18bWNgQjJ2GNg\tWrappedArray(Dentists, General Dentistry, Health & Medical, Oral Surgeons, Cosmetic Dentists, Orthodontists)\tAhwatukee\t[7:30-17:00,7:30-17:00,null,null,7:30-17:00,7:30-17:00,7:30-17:00]\t1\t33.3306902\t-111.9785992\tDental by Design\t\t85044\t22\t4.0\tAZ\tOrthodontists\n3101 Washington Rd\t[null,null,null,null,null,null,null,null,null,true,[false,true,false,false,false],false,null,null,null,null,null,null,null,true,null,[false,true,true,true,true,true,true,true],null,null,null,null,null,null,null,null,null,null,3,null,null,null,null,true,null]\tHe-G7vWjzVUysIKrfNbPUQ\tWrappedArray(Hair Stylists, Hair Salons, Men's Hair Salons, Blow Dry/Out Services, Hair Extensions, Beauty & Spas)\tMcMurray\t[9:00-16:00,9:00-20:00,8:00-16:00,null,9:00-20:00,9:00-20:00,9:00-20:00]\t1\t40.2916853\t-80.1048999\tStephen Szabo Salon\t\t15317\t11\t3.0\tPA\tHair Stylists\n3101 Washington Rd\t[null,null,null,null,null,null,null,null,null,true,[false,true,false,false,false],false,null,null,null,null,null,null,null,true,null,[false,true,true,true,true,true,true,true],null,null,null,null,null,null,null,null,null,null,3,null,null,null,null,true,null]\tHe-G7vWjzVUysIKrfNbPUQ\tWrappedArray(Hair Stylists, Hair Salons, Men's Hair Salons, Blow Dry/Out Services, Hair Extensions, Beauty & Spas)\tMcMurray\t[9:00-16:00,9:00-20:00,8:00-16:00,null,9:00-20:00,9:00-20:00,9:00-20:00]\t1\t40.2916853\t-80.1048999\tStephen Szabo Salon\t\t15317\t11\t3.0\tPA\tHair Salons\n3101 Washington Rd\t[null,null,null,null,null,null,null,null,null,true,[false,true,false,false,false],false,null,null,null,null,null,null,null,true,null,[false,true,true,true,true,true,true,true],null,null,null,null,null,null,null,null,null,null,3,null,null,null,null,true,null]\tHe-G7vWjzVUysIKrfNbPUQ\tWrappedArray(Hair Stylists, Hair Salons, Men's Hair Salons, Blow Dry/Out Services, Hair Extensions, Beauty & Spas)\tMcMurray\t[9:00-16:00,9:00-20:00,8:00-16:00,null,9:00-20:00,9:00-20:00,9:00-20:00]\t1\t40.2916853\t-80.1048999\tStephen Szabo Salon\t\t15317\t11\t3.0\tPA\tMen's Hair Salons\n3101 Washington Rd\t[null,null,null,null,null,null,null,null,null,true,[false,true,false,false,false],false,null,null,null,null,null,null,null,true,null,[false,true,true,true,true,true,true,true],null,null,null,null,null,null,null,null,null,null,3,null,null,null,null,true,null]\tHe-G7vWjzVUysIKrfNbPUQ\tWrappedArray(Hair Stylists, Hair Salons, Men's Hair Salons, Blow Dry/Out Services, Hair Extensions, Beauty & Spas)\tMcMurray\t[9:00-16:00,9:00-20:00,8:00-16:00,null,9:00-20:00,9:00-20:00,9:00-20:00]\t1\t40.2916853\t-80.1048999\tStephen Szabo Salon\t\t15317\t11\t3.0\tPA\tBlow Dry/Out Services\n"}]},"apps":[],"jobName":"paragraph_1529460827684_-266816797","id":"20180620-021347_1284119138","dateCreated":"2018-06-20T02:13:47+0000","dateStarted":"2018-06-20T02:14:09+0000","dateFinished":"2018-06-20T02:14:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17656"},{"text":"%md\n**Q2. Restaurant TABLE**\nCreate restaurant table from the table EXPLODED with the column cat_exploded=\"Restaurants\":\n- Q2.1. List 5 records with the columns name, review_count, stars, cat_exploded category from your restaurants table created -  cat_exploded column is renamed as category\n- Q2.2. query columns [name and nested object (attributes > ambience > romantic) of restaurants table: \n- Q2.3 find the number of restaurants in the dataset","user":"anonymous","dateUpdated":"2018-06-20T02:25:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p><strong>Q2. Restaurant TABLE</strong>\n<br  />Create restaurant table from the table EXPLODED with the column cat_exploded=&ldquo;Restaurants&rdquo;:</p>\n<ul>\n<li>Q2.1. List 5 records with the columns name, review_count, stars, cat_exploded category from your restaurants table created -  cat_exploded column is renamed as category</li>\n<li>Q2.2. query columns [name and nested object (attributes > ambience > romantic) of restaurants table:</li>\n<li>Q2.3 find the number of restaurants in the dataset</li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1529456871771_-194689199","id":"20180620-010751_1750512603","dateCreated":"2018-06-20T01:07:51+0000","dateStarted":"2018-06-20T01:22:28+0000","dateFinished":"2018-06-20T01:22:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17657"},{"text":"%pyspark\n#business_exp.filter(business_exp.category=='Restaurants').show(5)\n\nbusiness_exp_hc = hc.table(\"yelp2.business_exp\")\n\nrestaurant_hc = business_exp_hc.filter(business_exp_hc.category=='Restaurants')\n#business_exp_hc.filter(business_exp_hc.category=='Restaurants').show(5)\n\nrestaurant_hc.select('name', 'review_count', 'stars','category').show(5)\n\n","user":"anonymous","dateUpdated":"2018-06-20T04:01:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------------+-----+-----------+\n|                name|review_count|stars|   category|\n+--------------------+------------+-----+-----------+\n|Brick House Taver...|         116|  3.5|Restaurants|\n|             Messina|           5|  4.0|Restaurants|\n|   East Coast Coffee|           3|  4.5|Restaurants|\n|Showmars Governme...|           7|  3.5|Restaurants|\n|      Alize Catering|          12|  3.0|Restaurants|\n+--------------------+------------+-----+-----------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1529460918219_-1553093667","id":"20180620-021518_1930811843","dateCreated":"2018-06-20T02:15:18+0000","dateStarted":"2018-06-20T04:01:16+0000","dateFinished":"2018-06-20T04:01:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17658"},{"text":"%pyspark\n#business_exp_hc.select('attributes.ambience.romantic').distinct().show(5)\n\n#business_exp_hc.select('attributes.ambience.romantic').dropDuplicates().show(5)\n\n#business_exp_hc.select('attributes.ambience.romantic').dropna().show(5)\n#https://www.analyticsvidhya.com/blog/2016/10/spark-dataframe-and-operations/\n#http://www.learnbymarketing.com/1100/pyspark-joins-by-example/\n#business_exp_hc.select('attributes.ambience.romantic').filter(col('attributes.ambience.romantic').isNotNull()).show()\n\n#business_exp_hc.select('attributes.ambience.romantic').filter(col('attributes.ambience.romantic').isIn('true', 'false')).show()\n\n\n#business_exp_hc.select('attributes.ambience.romantic').fillna(-1).show(5)\n","user":"anonymous","dateUpdated":"2018-06-20T04:23:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-5657624894574792831.py\", line 367, in <module>\n    raise Exception(traceback.format_exc())\nException: Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-5657624894574792831.py\", line 360, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 1, in <module>\nTypeError: 'Column' object is not callable\n\n"}]},"apps":[],"jobName":"paragraph_1529461482594_-1121668906","id":"20180620-022442_1021064850","dateCreated":"2018-06-20T02:24:42+0000","dateStarted":"2018-06-20T04:22:38+0000","dateFinished":"2018-06-20T04:22:38+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:17659"},{"text":"%pyspark\n\nrestaurant_hc = hc.table(\"yelp2.business_exp\")\n\nrestaurant_hc.select(restaurant_hc.attributes.ambience.romantic).show(5);\n\n#restaurant_hc.filter(restaurant_hc.attributes.ambience.romantic != null).distinct().show(5);\n\n","user":"anonymous","dateUpdated":"2018-06-20T02:42:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1529461337285_-421717362","id":"20180620-022217_1876239313","dateCreated":"2018-06-20T02:22:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17661","dateFinished":"2018-06-20T02:42:34+0000","dateStarted":"2018-06-20T02:42:31+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------------+\n|attributes.ambience.romantic|\n+----------------------------+\n|                        null|\n|                        null|\n|                        null|\n|                        null|\n|                        null|\n+----------------------------+\nonly showing top 5 rows\n\n"}]}},{"text":"%md \n**Q3. Review TABLE**\n- Create Review_Filtered Table\n- using JOIN for review and restaurants with the same business_id\n- NOTE: In order to improve the performance, do you prefer review JOIN restaurant or the other way?\n- Q3.1. find the number of restaurant reviews from Review_Filtered Table","user":"anonymous","dateUpdated":"2018-06-20T01:23:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p><strong>Q3. Review TABLE</strong></p>\n<ul>\n<li>Create Review_Filtered Table</li>\n<li>using JOIN for review and restaurants with the same business_id</li>\n<li>NOTE: In order to improve the performance, do you prefer review JOIN restaurant or the other way?</li>\n<li>Q3.1. find the number of restaurant reviews from Review_Filtered Table</li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1529457210476_-685599268","id":"20180620-011330_1298150738","dateCreated":"2018-06-20T01:13:30+0000","dateStarted":"2018-06-20T01:23:12+0000","dateFinished":"2018-06-20T01:23:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17662"},{"text":"%md\n**Q4. Users TABLE**\n- User table 에서 find the number of all distinct users  in dataset","user":"anonymous","dateUpdated":"2018-06-20T01:24:05+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p><strong>Q4. Users TABLE</strong></p>\n<ul>\n<li>User table 에서 find the number of all distinct users  in dataset</li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1529457799611_-521837443","id":"20180620-012319_1759282151","dateCreated":"2018-06-20T01:23:19+0000","dateStarted":"2018-06-20T01:24:00+0000","dateFinished":"2018-06-20T01:24:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17663"},{"text":"%pyspark\n\nusers = sqlContext.read.option(\"inferSchema\", \"true\").json(\"s3://yelp-sk-test/yelp/user/user.json\")\n#users.printSchema()\nusers.select('user_id').distinct().count()\n","user":"anonymous","dateUpdated":"2018-06-20T02:33:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1529461874731_547506451","id":"20180620-023114_1557164049","dateCreated":"2018-06-20T02:31:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19182","dateFinished":"2018-06-20T02:33:01+0000","dateStarted":"2018-06-20T02:32:25+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- average_stars: double (nullable = true)\n |-- compliment_cool: long (nullable = true)\n |-- compliment_cute: long (nullable = true)\n |-- compliment_funny: long (nullable = true)\n |-- compliment_hot: long (nullable = true)\n |-- compliment_list: long (nullable = true)\n |-- compliment_more: long (nullable = true)\n |-- compliment_note: long (nullable = true)\n |-- compliment_photos: long (nullable = true)\n |-- compliment_plain: long (nullable = true)\n |-- compliment_profile: long (nullable = true)\n |-- compliment_writer: long (nullable = true)\n |-- cool: long (nullable = true)\n |-- elite: array (nullable = true)\n |    |-- element: long (containsNull = true)\n |-- fans: long (nullable = true)\n |-- friends: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- funny: long (nullable = true)\n |-- name: string (nullable = true)\n |-- review_count: long (nullable = true)\n |-- useful: long (nullable = true)\n |-- user_id: string (nullable = true)\n |-- yelping_since: string (nullable = true)\n\n1326101\n"}]}},{"text":"%md\n**5. Users/Elite TABLE**\n- Q5.1. select 4 records with the COLUMN elite from USERS table, which is generated from user.json to see elite users: NOTE: table should be USERS not USER\n- Q5.2. Create Elite_Users Table by exploding elite column as elite_year column using LATERAL VIEW in order to separate elite users: For example, [2016, 2017, 2018] => 3 exploded records as follows:","user":"anonymous","dateUpdated":"2018-06-20T02:33:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p><strong>5. Users/Elite TABLE</strong></p>\n<ul>\n<li>Q5.1. select 4 records with the COLUMN elite from USERS table, which is generated from user.json to see elite users: NOTE: table should be USERS not USER</li>\n<li>Q5.2. Create Elite_Users Table by exploding elite column as elite_year column using LATERAL VIEW in order to separate elite users: For example, [2016, 2017, 2018] => 3 exploded records as follows:</li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1529457849107_701172041","id":"20180620-012409_1788094082","dateCreated":"2018-06-20T01:24:09+0000","dateStarted":"2018-06-20T01:31:26+0000","dateFinished":"2018-06-20T01:31:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17664"},{"text":"%pyspark\nusers = sqlContext.read.option(\"inferSchema\", \"true\").json(\"s3://yelp-sk-test/yelp/user/user.json\")\nusers.select(\"elite\").show(4)","user":"anonymous","dateUpdated":"2018-06-20T04:08:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1529458092224_-36823966","id":"20180620-012812_2035355574","dateCreated":"2018-06-20T01:28:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17665","dateFinished":"2018-06-20T04:08:38+0000","dateStarted":"2018-06-20T04:08:00+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+\n|elite|\n+-----+\n|   []|\n|   []|\n|   []|\n|   []|\n+-----+\nonly showing top 4 rows\n\n"}]}},{"text":"%pyspark\nusers = sqlContext.read.option(\"inferSchema\", \"true\").json(\"s3://yelp-sk-test/yelp/user/user.json\")\n#users.printSchema()\nusers_exp = users.withColumn(\"elite_year\", explode(col('elite'))) \n#users_exp.show()\nusers_exp.filter(users_exp.elite_year ==2016).show()\n\n\n","user":"anonymous","dateUpdated":"2018-06-20T02:43:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1529462021076_-1404508610","id":"20180620-023341_561836425","dateCreated":"2018-06-20T02:33:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19306","dateFinished":"2018-06-20T02:41:37+0000","dateStarted":"2018-06-20T02:41:17+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+---------------+---------------+----------------+--------------+---------------+---------------+---------------+-----------------+----------------+------------------+-----------------+----+--------------------+----+--------------------+-----+-------+------------+------+--------------------+-------------+----------+\n|average_stars|compliment_cool|compliment_cute|compliment_funny|compliment_hot|compliment_list|compliment_more|compliment_note|compliment_photos|compliment_plain|compliment_profile|compliment_writer|cool|               elite|fans|             friends|funny|   name|review_count|useful|             user_id|yelping_since|elite_year|\n+-------------+---------------+---------------+----------------+--------------+---------------+---------------+---------------+-----------------+----------------+------------------+-----------------+----+--------------------+----+--------------------+-----+-------+------------+------+--------------------+-------------+----------+\n|          3.6|             47|              7|              47|            20|              0|              4|             16|                1|              52|                 2|               14|  67|[2014, 2016, 2013...|  27|[Cit5yho-DqotA0Bn...|  151|  Kenny|         762|   174|aw973Pm1nrTbRjP4z...|   2008-09-23|      2016|\n|         3.71|             13|              0|              13|            10|              0|              1|              5|                4|              16|                 0|               14|  33|[2016, 2017, 2014...|  13|[aLvxbF2DueKFOqul...|   12|Evelina|          85|    51|i5jSTSpXJtvM-ExWR...|   2014-03-17|      2016|\n|         3.86|             22|              0|              22|            23|              0|              3|             11|                3|              25|                 2|               17|   7|[2015, 2013, 2014...|  13|[uIjj7EIVBU4kGNgm...|   36|Michael|         447|    35|snDjs1hdh7JOWv4jj...|   2008-11-19|      2016|\n|         3.79|              9|              0|               9|             0|              0|              2|              2|                2|               3|                 2|                0|   2|        [2017, 2016]|   9|[f0VR4LGz8hZuOb8k...|   11| Martin|          88|    22|MgAHuFGzScMAuLpDm...|   2012-04-09|      2016|\n|         3.66|             42|              7|              42|            44|              4|              7|             25|                9|              41|                 4|               39|   9|[2010, 2017, 2015...| 101|[uIjj7EIVBU4kGNgm...|   54|    Buo|         902|    72|oH9K7eCuNsYr6MmlM...|   2007-11-10|      2016|\n|         3.92|            105|              4|             105|            68|              0|             21|             34|               19|             109|                11|               56| 268|[2016, 2014, 2017...|  32|[PhKd2vl7rWQZ8Gvj...|  253|  Marna|         246|   398|z9MozWK9f7C8p3Gj0...|   2009-10-17|      2016|\n|         4.13|             30|              3|              30|            36|              0|              2|             13|               38|              17|                 6|               25|  27|  [2016, 2017, 2015]|  43|[mJu87ByCduiA4gWa...|   27|  Ellen|         228|    52|qSh-q8M-rL4PRVukX...|   2007-12-28|      2016|\n|         3.77|             73|              0|              73|            20|              2|              3|             29|               30|              60|                 4|               24| 415|[2016, 2017, 2013...|  54|[-x1516ZG5GllZiBj...|  316|   Alan|         646|   460|lmJy4OwP_TyHIg8a8...|   2013-06-14|      2016|\n|         3.43|             54|              2|              54|            23|              2|              5|             18|               41|              49|                 3|               30|5215|  [2016, 2015, 2017]| 119|[vbvGTfxCNPU0Owja...|  312|  Hazel|         229|  4749|keLUgL_4y60BkppiA...|   2014-06-21|      2016|\n|         4.25|             10|              0|              10|             6|              0|              5|              3|               21|              19|                 1|               10|  45|        [2017, 2016]| 100|[rODAOCuGhUBZ4WWx...|   11|Charlie|         380|   147|yHbrIShhhHkkl20_K...|   2010-11-07|      2016|\n|         3.38|             24|              0|              24|             8|              0|              4|             17|                8|              42|                 0|               14| 128|  [2015, 2017, 2016]|   8|[vbvGTfxCNPU0Owja...|    1|  Kenny|          91|    44|KBVL9aPlcLVwqyFQ_...|   2011-09-19|      2016|\n|         4.09|             50|              3|              50|            33|              2|              4|             26|               31|              51|                 5|               24| 277|[2017, 2015, 2014...|  57|[0ab1OLsfs3F7Olq-...|  203|  Karen|         388|   412|mqzisCyZ_tlpQt6Hk...|   2009-04-10|      2016|\n|         3.94|             35|              3|              35|            19|              0|              5|             13|                4|              25|                 2|                9|  69|[2012, 2016, 2011...|  28|[saJuyv784apZzH--...|   40| Krista|         324|    80|1D5EQITb4hOzPMZT8...|   2008-12-23|      2016|\n|         4.27|              3|              0|               3|             0|              0|              0|              1|                4|               4|                 0|                0|   1|        [2016, 2017]|  17|[FS_rXTD2DDTat-jM...|    1| Elaine|          62|    20|XOUoC47nYcSUCuzKR...|   2010-10-13|      2016|\n|         3.85|              2|              0|               2|             0|              0|              0|              2|                2|               3|                 0|                1|   0|  [2015, 2016, 2017]|   9|[AcD7M8pWRPnGVrBV...|    1|  Erick|         243|     4|GmzbU3b4PAbDzkiQK...|   2010-10-24|      2016|\n|         3.64|             10|              1|              10|             6|              1|              1|              2|                0|               7|                 0|                9|  19|[2017, 2016, 2015...|  13|[KBVL9aPlcLVwqyFQ...|   18|  Diana|         131|   108|dEDId4Rp2JpblIfYI...|   2011-10-01|      2016|\n|         3.03|              2|              1|               2|             3|              0|              3|              2|                1|               2|                 0|                3|   4|[2015, 2017, 2016...|   7|[KBVL9aPlcLVwqyFQ...|    6|   Anna|          93|    22|EyVtVVwWmijNMJqBG...|   2013-02-02|      2016|\n|         4.02|             33|              0|              33|            26|              0|              2|              9|                1|              33|                 0|                9|  17|[2016, 2012, 2014...|  20|[o-AvZ1UAOMjSqkw_...|    2|    Nic|         443|    18|31d4d1tVHxT_8LfPv...|   2009-07-15|      2016|\n|          3.8|              6|              0|               6|             5|              0|              5|              8|                3|               4|                 1|                8|  35|  [2016, 2017, 2015]|  17|[tTp0bo1hyaRQ1fRj...|   49|  Nancy|         225|   245|W1p8_CFW5FISSihmQ...|   2010-11-26|      2016|\n|         4.15|             84|              1|              84|            65|              1|              9|             66|                8|              77|                 6|               48|  73|[2011, 2013, 2016...|  43|[b_1LJQVNVO0ksCeW...|   44| Alexis|         584|   536|KtERwGUIK2urGM1me...|   2011-03-11|      2016|\n+-------------+---------------+---------------+----------------+--------------+---------------+---------------+---------------+-----------------+----------------+------------------+-----------------+----+--------------------+----+--------------------+-----+-------+------------+------+--------------------+-------------+----------+\nonly showing top 20 rows\n\n"}]}},{"text":"%pyspark\nfrom pyspark.sql.functions import col\n\nusers_exp.where(col(\"elite_year\").isin({2016, 2017, 2018})).show()","user":"anonymous","dateUpdated":"2018-06-20T02:44:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1529462610385_2101009783","id":"20180620-024330_196335047","dateCreated":"2018-06-20T02:43:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19776","dateFinished":"2018-06-20T02:43:45+0000","dateStarted":"2018-06-20T02:43:36+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+---------------+---------------+----------------+--------------+---------------+---------------+---------------+-----------------+----------------+------------------+-----------------+----+--------------------+----+--------------------+-----+-------+------------+------+--------------------+-------------+----------+\n|average_stars|compliment_cool|compliment_cute|compliment_funny|compliment_hot|compliment_list|compliment_more|compliment_note|compliment_photos|compliment_plain|compliment_profile|compliment_writer|cool|               elite|fans|             friends|funny|   name|review_count|useful|             user_id|yelping_since|elite_year|\n+-------------+---------------+---------------+----------------+--------------+---------------+---------------+---------------+-----------------+----------------+------------------+-----------------+----+--------------------+----+--------------------+-----+-------+------------+------+--------------------+-------------+----------+\n|          3.6|             47|              7|              47|            20|              0|              4|             16|                1|              52|                 2|               14|  67|[2014, 2016, 2013...|  27|[Cit5yho-DqotA0Bn...|  151|  Kenny|         762|   174|aw973Pm1nrTbRjP4z...|   2008-09-23|      2016|\n|         4.27|              8|              0|               8|             2|              0|              0|              4|               10|               5|                 0|                7|  15|              [2017]|   9|[WKIW7tWyMq7_XN0V...|    9|   Tony|          34|    31|iWMxMUWNXfdvVl9oX...|   2011-08-14|      2017|\n|         3.71|             13|              0|              13|            10|              0|              1|              5|                4|              16|                 0|               14|  33|[2016, 2017, 2014...|  13|[aLvxbF2DueKFOqul...|   12|Evelina|          85|    51|i5jSTSpXJtvM-ExWR...|   2014-03-17|      2016|\n|         3.71|             13|              0|              13|            10|              0|              1|              5|                4|              16|                 0|               14|  33|[2016, 2017, 2014...|  13|[aLvxbF2DueKFOqul...|   12|Evelina|          85|    51|i5jSTSpXJtvM-ExWR...|   2014-03-17|      2017|\n|         3.86|             22|              0|              22|            23|              0|              3|             11|                3|              25|                 2|               17|   7|[2015, 2013, 2014...|  13|[uIjj7EIVBU4kGNgm...|   36|Michael|         447|    35|snDjs1hdh7JOWv4jj...|   2008-11-19|      2017|\n|         3.86|             22|              0|              22|            23|              0|              3|             11|                3|              25|                 2|               17|   7|[2015, 2013, 2014...|  13|[uIjj7EIVBU4kGNgm...|   36|Michael|         447|    35|snDjs1hdh7JOWv4jj...|   2008-11-19|      2016|\n|         3.79|              9|              0|               9|             0|              0|              2|              2|                2|               3|                 2|                0|   2|        [2017, 2016]|   9|[f0VR4LGz8hZuOb8k...|   11| Martin|          88|    22|MgAHuFGzScMAuLpDm...|   2012-04-09|      2017|\n|         3.79|              9|              0|               9|             0|              0|              2|              2|                2|               3|                 2|                0|   2|        [2017, 2016]|   9|[f0VR4LGz8hZuOb8k...|   11| Martin|          88|    22|MgAHuFGzScMAuLpDm...|   2012-04-09|      2016|\n|         3.66|             42|              7|              42|            44|              4|              7|             25|                9|              41|                 4|               39|   9|[2010, 2017, 2015...| 101|[uIjj7EIVBU4kGNgm...|   54|    Buo|         902|    72|oH9K7eCuNsYr6MmlM...|   2007-11-10|      2017|\n|         3.66|             42|              7|              42|            44|              4|              7|             25|                9|              41|                 4|               39|   9|[2010, 2017, 2015...| 101|[uIjj7EIVBU4kGNgm...|   54|    Buo|         902|    72|oH9K7eCuNsYr6MmlM...|   2007-11-10|      2016|\n|         3.92|            105|              4|             105|            68|              0|             21|             34|               19|             109|                11|               56| 268|[2016, 2014, 2017...|  32|[PhKd2vl7rWQZ8Gvj...|  253|  Marna|         246|   398|z9MozWK9f7C8p3Gj0...|   2009-10-17|      2016|\n|         3.92|            105|              4|             105|            68|              0|             21|             34|               19|             109|                11|               56| 268|[2016, 2014, 2017...|  32|[PhKd2vl7rWQZ8Gvj...|  253|  Marna|         246|   398|z9MozWK9f7C8p3Gj0...|   2009-10-17|      2017|\n|         4.13|             30|              3|              30|            36|              0|              2|             13|               38|              17|                 6|               25|  27|  [2016, 2017, 2015]|  43|[mJu87ByCduiA4gWa...|   27|  Ellen|         228|    52|qSh-q8M-rL4PRVukX...|   2007-12-28|      2016|\n|         4.13|             30|              3|              30|            36|              0|              2|             13|               38|              17|                 6|               25|  27|  [2016, 2017, 2015]|  43|[mJu87ByCduiA4gWa...|   27|  Ellen|         228|    52|qSh-q8M-rL4PRVukX...|   2007-12-28|      2017|\n|         4.31|              0|              0|               0|             0|              0|              0|              2|                0|               0|                 0|                1|   0|              [2017]|   1|[AMRKTA3DnPGoitej...|    3| Yunlin|          25|     4|mdx_uzqOvgtcnCLT-...|   2016-08-23|      2017|\n|         3.96|              1|              0|               1|             0|              0|              0|              1|                0|               1|                 0|                1|   7|              [2017]|   9|[-u98lW1hOP4KSbCS...|    6|    May|          89|    18|a-0mMaTKiYTuw9c61...|   2011-11-07|      2017|\n|         3.77|             73|              0|              73|            20|              2|              3|             29|               30|              60|                 4|               24| 415|[2016, 2017, 2013...|  54|[-x1516ZG5GllZiBj...|  316|   Alan|         646|   460|lmJy4OwP_TyHIg8a8...|   2013-06-14|      2016|\n|         3.77|             73|              0|              73|            20|              2|              3|             29|               30|              60|                 4|               24| 415|[2016, 2017, 2013...|  54|[-x1516ZG5GllZiBj...|  316|   Alan|         646|   460|lmJy4OwP_TyHIg8a8...|   2013-06-14|      2017|\n|         3.43|             54|              2|              54|            23|              2|              5|             18|               41|              49|                 3|               30|5215|  [2016, 2015, 2017]| 119|[vbvGTfxCNPU0Owja...|  312|  Hazel|         229|  4749|keLUgL_4y60BkppiA...|   2014-06-21|      2016|\n|         3.43|             54|              2|              54|            23|              2|              5|             18|               41|              49|                 3|               30|5215|  [2016, 2015, 2017]| 119|[vbvGTfxCNPU0Owja...|  312|  Hazel|         229|  4749|keLUgL_4y60BkppiA...|   2014-06-21|      2017|\n+-------------+---------------+---------------+----------------+--------------+---------------+---------------+---------------+-----------------+----------------+------------------+-----------------+----+--------------------+----+--------------------+-----+-------+------------+------+--------------------+-------------+----------+\nonly showing top 20 rows\n\n"}]}},{"text":"%md\n**6. Visualization**\n- gradient map\n- Which Cities Have The Highest Number Of   Restaurants? In order to map restaurants across United, Select the columns (city, count of business_id as number_city  ) by grouping data of restaurants table by city and then order it by number_city\n- Find out Top 15 Sub-Categories Of  Restaurants from tables exploded  and restaurants with business_id and grouping by cat_exploded column of the table exploded, which are not in (\"Restaurants\",\"Food\")\n- Distribution of ratings vs  categories:\n테이블 ratings를 앞서 만든 테이블 exploded 와 restaurant을 가지고 같은 business_id로 조인하여 다음의 조건을 만족하여 만드세요\n- What ratings do the majority of restaurants   have?\n- Rating distribution in restaurant  review","user":"anonymous","dateUpdated":"2018-06-20T01:35:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p><strong>6. Visualization</strong></p>\n<ul>\n<li>gradient map</li>\n<li>Which Cities Have The Highest Number Of   Restaurants? In order to map restaurants across United, Select the columns (city, count of business_id as number_city  ) by grouping data of restaurants table by city and then order it by number_city</li>\n<li>Find out Top 15 Sub-Categories Of  Restaurants from tables exploded  and restaurants with business_id and grouping by cat_exploded column of the table exploded, which are not in (&ldquo;Restaurants&rdquo;,&ldquo;Food&rdquo;)</li>\n<li>Distribution of ratings vs  categories:\n<br  />테이블 ratings를 앞서 만든 테이블 exploded 와 restaurant을 가지고 같은 business_id로 조인하여 다음의 조건을 만족하여 만드세요</li>\n<li>What ratings do the majority of restaurants   have?</li>\n<li>Rating distribution in restaurant  review</li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1529457941381_-856201206","id":"20180620-012541_1761012569","dateCreated":"2018-06-20T01:25:41+0000","dateStarted":"2018-06-20T01:35:04+0000","dateFinished":"2018-06-20T01:35:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17666"},{"text":"%pyspark\nbusiness_cat = business.withColumn(\"cat\", explode(col('categories')))\n# business_cat.show(10)\nrestaurant = business_cat.filter((business_cat.cat == 'Restaurants') | (business_cat.cat == 'Food'))\nrestaurant.show(10)\nrestaurant.createTempView(\"restaurant\")","user":"anonymous","dateUpdated":"2018-06-20T04:38:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1529467741187_1478010940","id":"20180620-040901_1947430220","dateCreated":"2018-06-20T04:09:01+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19904","dateFinished":"2018-06-20T04:38:41+0000","dateStarted":"2018-06-20T04:38:24+0000","results":{"code":"ERROR","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+--------------+--------------------+-------+-------------+--------------+--------------------+------------------+-----------+------------+-----+-----+-----------+\n|             address|          attributes|         business_id|          categories|          city|               hours|is_open|     latitude|     longitude|                name|      neighborhood|postal_code|review_count|stars|state|        cat|\n+--------------------+--------------------+--------------------+--------------------+--------------+--------------------+-------+-------------+--------------+--------------------+------------------+-----------+------------+-----+-----+-----------+\n|        581 Howe Ave|[,, full_bar, [tr...|PfOCPjBrlQAnz__NX...|[American (New), ...|Cuyahoga Falls|[11:00-1:00, 11:0...|      1|   41.1195346|   -81.4756898|Brick House Taver...|                  |      44221|         116|  3.5|   OH|Restaurants|\n|      Richterstr. 11|[,, beer_and_wine...|o9eMRCWt5PkpLDE0g...|[Italian, Restaur...|     Stuttgart|[18:00-0:00, 18:0...|      1|      48.7272|       9.14795|             Messina|                  |      70567|           5|  4.0|   BW|Restaurants|\n|2612 Brandt Schoo...|[,,,,,,, false,, ...|EsMcGiZaQuG1OOvL9...|[Coffee & Tea, Ic...|       Wexford|            [,,,,,,]|      1|40.6151022445|-80.0913487465|    Any Given Sundae|                  |      15090|          15|  5.0|   PA|       Food|\n|    737 West Pike St|[,, none,,,,, tru...|XOSRcvtaKc_Q5H1SA...|[Breakfast & Brun...|       Houston|            [,,,,,,]|      0|40.2415480142|-80.2128151059|   East Coast Coffee|                  |      15342|           3|  4.5|   PA|       Food|\n|    737 West Pike St|[,, none,,,,, tru...|XOSRcvtaKc_Q5H1SA...|[Breakfast & Brun...|       Houston|            [,,,,,,]|      0|40.2415480142|-80.2128151059|   East Coast Coffee|                  |      15342|           3|  4.5|   PA|Restaurants|\n|    35 Main Street N|[,,,,,,, true,, f...|xcgFnd-MwkZeO5G2H...|[Bakeries, Bagels...|       Markham|            [,,,,,,]|      1|   43.8751774|   -79.2601532|T & T Bakery and ...|   Markham Village|    L3P 1X3|          38|  4.0|   ON|       Food|\n|        600 E 4th St|[,,, [false, fals...|fNMVV_ZX7CJSDWQGd...|[Restaurants, Ame...|     Charlotte|[7:00-15:00, 7:00...|      1|   35.2216474|   -80.8393449|Showmars Governme...|            Uptown|      28202|           7|  3.5|   NC|Restaurants|\n|       2459 Yonge St|[,, full_bar, [fa...|l09JfMeQ6ynYs5MCJ...|[Italian, French,...|       Toronto|[9:00-22:00, 9:00...|      0|   43.7113993|   -79.3993388|      Alize Catering|Yonge and Eglinton|    M4P 2H6|          12|  3.0|   ON|Restaurants|\n|9665 Bayview Aven...|[,, full_bar, [tr...|Gu-xs3NIQTj3Mj2xY...|[French, Food, Ba...| Richmond Hill|[11:30-23:00, 11:...|      1|   43.8675648|   -79.4126618|Maxim Bakery & Re...|                  |    L4C 9V4|          34|  3.5|   ON|       Food|\n|9665 Bayview Aven...|[,, full_bar, [tr...|Gu-xs3NIQTj3Mj2xY...|[French, Food, Ba...| Richmond Hill|[11:30-23:00, 11:...|      1|   43.8675648|   -79.4126618|Maxim Bakery & Re...|                  |    L4C 9V4|          34|  3.5|   ON|Restaurants|\n+--------------------+--------------------+--------------------+--------------------+--------------+--------------------+-------+-------------+--------------+--------------------+------------------+-----------+------------+-----+-----+-----------+\nonly showing top 10 rows\n\n"},{"type":"TEXT","data":"Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-5657624894574792831.py\", line 367, in <module>\n    raise Exception(traceback.format_exc())\nException: Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-5657624894574792831.py\", line 360, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 4, in <module>\n  File \"/usr/lib/spark/python/pyspark/sql/dataframe.py\", line 158, in createTempView\n    self._jdf.createTempView(name)\n  File \"/usr/lib/spark/python/lib/py4j-0.10.6-src.zip/py4j/java_gateway.py\", line 1160, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/usr/lib/spark/python/pyspark/sql/utils.py\", line 71, in deco\n    raise AnalysisException(s.split(': ', 1)[1], stackTrace)\nAnalysisException: u\"Temporary view 'restaurant' already exists;\"\n\n"}]}},{"text":"%sql\n\nselect count(business_id) num, city\nfrom restaurant\ngroup by city\norder by num desc\nlimit 15","user":"anonymous","dateUpdated":"2018-06-20T04:38:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1529469507961_1491955490","id":"20180620-043827_498393637","dateCreated":"2018-06-20T04:38:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19975","dateFinished":"2018-06-20T04:38:53+0000","dateStarted":"2018-06-20T04:38:46+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"num\tcity\n10627\tToronto\n8769\tLas Vegas\n5459\tPhoenix\n4662\tMontréal\n3663\tCharlotte\n3299\tPittsburgh\n2315\tEdinburgh\n2171\tScottsdale\n1964\tCleveland\n1783\tMississauga\n1648\tMesa\n1531\tMadison\n1483\tStuttgart\n1454\tTempe\n1259\tHenderson\n"}]}},{"text":"%sql\nselect stars, count(*)\nfrom restaurant\ngroup by stars\norder by stars asc","user":"anonymous","dateUpdated":"2018-06-20T04:49:14+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1529469541369_511862123","id":"20180620-043901_958288376","dateCreated":"2018-06-20T04:39:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20058","dateFinished":"2018-06-20T04:49:12+0000","dateStarted":"2018-06-20T04:48:56+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"stars\tcount(1)\n1.0\t466\n1.5\t1492\n2.0\t3954\n2.5\t7336\n3.0\t13309\n3.5\t18239\n4.0\t19807\n4.5\t11426\n5.0\t3366\n"}]}},{"text":"%md\n**7. Which restaurants get bad vs good   reviews?**\n- Good Review\n- Bad Review","user":"anonymous","dateUpdated":"2018-06-20T01:30:44+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p><strong>7. Which restaurants get bad vs good   reviews?</strong></p>\n<ul>\n<li>Good Review</li>\n<li>Bad Review</li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1529458005271_1856586668","id":"20180620-012645_15473961","dateCreated":"2018-06-20T01:26:45+0000","dateStarted":"2018-06-20T01:30:00+0000","dateFinished":"2018-06-20T01:30:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17667"},{"text":"%md\n**8. Which restaurants have the most  reviews?**\n","user":"anonymous","dateUpdated":"2018-06-20T01:30:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p><strong>8. Which restaurants have the most  reviews?</strong></p>\n"}]},"apps":[],"jobName":"paragraph_1529458202696_809556860","id":"20180620-013002_1495824897","dateCreated":"2018-06-20T01:30:02+0000","dateStarted":"2018-06-20T01:30:23+0000","dateFinished":"2018-06-20T01:30:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17668"},{"text":"%md\n**9. What number of yelp users are   elite?**\n- Average rating by all users\n- Average rating by elite users\n- Count number of elite users by year\n- Count average reviews by elite users by year","user":"anonymous","dateUpdated":"2018-06-20T01:31:36+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p><strong>9. What number of yelp users are   elite?</strong></p>\n<ul>\n<li>Average rating by all users</li>\n<li>Average rating by elite users</li>\n<li>Count number of elite users by year</li>\n<li>Count average reviews by elite users by year</li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1529458225911_-995654331","id":"20180620-013025_210668886","dateCreated":"2018-06-20T01:30:25+0000","dateStarted":"2018-06-20T01:31:17+0000","dateFinished":"2018-06-20T01:31:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17669"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1529457641686_412535390","id":"20180620-012041_1657587696","dateCreated":"2018-06-20T01:20:41+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:17670"}],"name":"SK Big Data Lecture","id":"2DKD8JKEE","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}